/**
 * @license
 * Copyright 2013 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(window.google!==void 0){let e=function(t){var r=t||{};this.ready_=!1,this.dragging_=!1,t.visible==null&&(t.visible=!0),t.shadow==null&&(t.shadow="7px -3px 5px rgba(88,88,88,0.7)"),t.anchor==null&&(t.anchor=a.BOTTOM),this.setValues(r)};var RichMarker=e;e.prototype=new google.maps.OverlayView,window.RichMarker=e,e.prototype.getVisible=function(){return this.get("visible")},e.prototype.getVisible=e.prototype.getVisible,e.prototype.setVisible=function(t){this.set("visible",t)},e.prototype.setVisible=e.prototype.setVisible,e.prototype.visible_changed=function(){this.ready_&&(this.markerWrapper_.style.display=this.getVisible()?"":"none",this.draw())},e.prototype.visible_changed=e.prototype.visible_changed,e.prototype.setFlat=function(t){this.set("flat",!!t)},e.prototype.setFlat=e.prototype.setFlat,e.prototype.getFlat=function(){return this.get("flat")},e.prototype.getFlat=e.prototype.getFlat,e.prototype.getWidth=function(){return this.get("width")},e.prototype.getWidth=e.prototype.getWidth,e.prototype.getHeight=function(){return this.get("height")},e.prototype.getHeight=e.prototype.getHeight,e.prototype.setShadow=function(t){this.set("shadow",t),this.flat_changed()},e.prototype.setShadow=e.prototype.setShadow,e.prototype.getShadow=function(){return this.get("shadow")},e.prototype.getShadow=e.prototype.getShadow,e.prototype.flat_changed=function(){!this.ready_||(this.markerWrapper_.style.boxShadow=this.markerWrapper_.style.webkitBoxShadow=this.markerWrapper_.style.MozBoxShadow=this.getFlat()?"":this.getShadow())},e.prototype.flat_changed=e.prototype.flat_changed,e.prototype.setZIndex=function(t){this.set("zIndex",t)},e.prototype.setZIndex=e.prototype.setZIndex,e.prototype.getZIndex=function(){return this.get("zIndex")},e.prototype.getZIndex=e.prototype.getZIndex,e.prototype.zIndex_changed=function(){this.getZIndex()&&this.ready_&&(this.markerWrapper_.style.zIndex=this.getZIndex())},e.prototype.zIndex_changed=e.prototype.zIndex_changed,e.prototype.getDraggable=function(){return this.get("draggable")},e.prototype.getDraggable=e.prototype.getDraggable,e.prototype.setDraggable=function(t){this.set("draggable",!!t)},e.prototype.setDraggable=e.prototype.setDraggable,e.prototype.draggable_changed=function(){this.ready_&&(this.getDraggable()?this.addDragging_(this.markerWrapper_):this.removeDragListeners_())},e.prototype.draggable_changed=e.prototype.draggable_changed,e.prototype.getPosition=function(){return this.get("position")},e.prototype.getPosition=e.prototype.getPosition,e.prototype.setPosition=function(t){this.set("position",t)},e.prototype.setPosition=e.prototype.setPosition,e.prototype.position_changed=function(){this.draw()},e.prototype.position_changed=e.prototype.position_changed,e.prototype.getAnchor=function(){return this.get("anchor")},e.prototype.getAnchor=e.prototype.getAnchor,e.prototype.setAnchor=function(t){this.set("anchor",t)},e.prototype.setAnchor=e.prototype.setAnchor,e.prototype.anchor_changed=function(){this.draw()},e.prototype.anchor_changed=e.prototype.anchor_changed,e.prototype.htmlToDocumentFragment_=function(t){var r=document.createElement("DIV");if(r.innerHTML=t,r.childNodes.length==1)return r.removeChild(r.firstChild);for(var o=document.createDocumentFragment();r.firstChild;)o.appendChild(r.firstChild);return o},e.prototype.removeChildren_=function(t){if(!!t)for(var r;r=t.firstChild;)t.removeChild(r)},e.prototype.setContent=function(t){this.set("content",t)},e.prototype.setContent=e.prototype.setContent,e.prototype.getContent=function(){return this.get("content")},e.prototype.getContent=e.prototype.getContent,e.prototype.content_changed=function(){if(!!this.markerContent_){this.removeChildren_(this.markerContent_);var t=this.getContent();if(t){typeof t=="string"&&(t=t.replace(/^\s*([\S\s]*)\b\s*$/,"$1"),t=this.htmlToDocumentFragment_(t)),this.markerContent_.appendChild(t);for(var r=this,o=this.markerContent_.getElementsByTagName("IMG"),i=0,s;s=o[i];i++)google.maps.event.addDomListener(s,"mousedown",function(n){r.getDraggable()&&(n.preventDefault&&n.preventDefault(),n.returnValue=!1)}),google.maps.event.addDomListener(s,"load",function(){r.draw()});google.maps.event.trigger(this,"domready")}this.ready_&&this.draw()}},e.prototype.content_changed=e.prototype.content_changed,e.prototype.setCursor_=function(t){if(!!this.ready_){var r="";navigator.userAgent.indexOf("Gecko/")!==-1?(t=="dragging"&&(r="-moz-grabbing"),t=="dragready"&&(r="-moz-grab"),t=="draggable"&&(r="pointer")):((t=="dragging"||t=="dragready")&&(r="move"),t=="draggable"&&(r="pointer")),this.markerWrapper_.style.cursor!=r&&(this.markerWrapper_.style.cursor=r)}},e.prototype.startDrag=function(t){if(!!this.getDraggable()&&!this.dragging_){this.dragging_=!0;var r=this.getMap();this.mapDraggable_=r.get("draggable"),r.set("draggable",!1),this.mouseX_=t.clientX,this.mouseY_=t.clientY,this.setCursor_("dragready"),this.markerWrapper_.style.MozUserSelect="none",this.markerWrapper_.style.KhtmlUserSelect="none",this.markerWrapper_.style.WebkitUserSelect="none",this.markerWrapper_.unselectable="on",this.markerWrapper_.onselectstart=function(){return!1},this.addDraggingListeners_(),google.maps.event.trigger(this,"dragstart")}},e.prototype.stopDrag=function(){!this.getDraggable()||this.dragging_&&(this.dragging_=!1,this.getMap().set("draggable",this.mapDraggable_),this.mouseX_=this.mouseY_=this.mapDraggable_=null,this.markerWrapper_.style.MozUserSelect="",this.markerWrapper_.style.KhtmlUserSelect="",this.markerWrapper_.style.WebkitUserSelect="",this.markerWrapper_.unselectable="off",this.markerWrapper_.onselectstart=function(){},this.removeDraggingListeners_(),this.setCursor_("draggable"),google.maps.event.trigger(this,"dragend"),this.draw())},e.prototype.drag=function(t){if(!this.getDraggable()||!this.dragging_){this.stopDrag();return}var r=this.mouseX_-t.clientX,o=this.mouseY_-t.clientY;this.mouseX_=t.clientX,this.mouseY_=t.clientY;var i=parseInt(this.markerWrapper_.style.left,10)-r,s=parseInt(this.markerWrapper_.style.top,10)-o;this.markerWrapper_.style.left=i+"px",this.markerWrapper_.style.top=s+"px";var n=this.getOffset_(),p=new google.maps.Point(i-n.width,s-n.height),g=this.getProjection();this.setPosition(g.fromDivPixelToLatLng(p)),this.setCursor_("dragging"),google.maps.event.trigger(this,"drag")},e.prototype.removeDragListeners_=function(){this.draggableListener_&&(google.maps.event.removeListener(this.draggableListener_),delete this.draggableListener_),this.setCursor_("")},e.prototype.addDragging_=function(t){if(!!t){var r=this;this.draggableListener_=google.maps.event.addDomListener(t,"mousedown",function(o){r.startDrag(o)}),this.setCursor_("draggable")}},e.prototype.addDraggingListeners_=function(){var t=this;this.markerWrapper_.setCapture?(this.markerWrapper_.setCapture(!0),this.draggingListeners_=[google.maps.event.addDomListener(this.markerWrapper_,"mousemove",function(r){t.drag(r)},!0),google.maps.event.addDomListener(this.markerWrapper_,"mouseup",function(){t.stopDrag(),t.markerWrapper_.releaseCapture()},!0)]):this.draggingListeners_=[google.maps.event.addDomListener(window,"mousemove",function(r){t.drag(r)},!0),google.maps.event.addDomListener(window,"mouseup",function(){t.stopDrag()},!0)]},e.prototype.removeDraggingListeners_=function(){if(this.draggingListeners_){for(var t=0,r;r=this.draggingListeners_[t];t++)google.maps.event.removeListener(r);this.draggingListeners_.length=0}},e.prototype.getOffset_=function(){var t=this.getAnchor();if(typeof t=="object")return t;var r=new google.maps.Size(0,0);if(!this.markerContent_)return r;var o=this.markerContent_.offsetWidth,i=this.markerContent_.offsetHeight;switch(t){case a.TOP_LEFT:break;case a.TOP:r.width=-o/2;break;case a.TOP_RIGHT:r.width=-o;break;case a.LEFT:r.height=-i/2;break;case a.MIDDLE:r.width=-o/2,r.height=-i/2;break;case a.RIGHT:r.width=-o,r.height=-i/2;break;case a.BOTTOM_LEFT:r.height=-i;break;case a.BOTTOM:r.width=-o/2,r.height=-i;break;case a.BOTTOM_RIGHT:r.width=-o,r.height=-i;break}return r},e.prototype.onAdd=function(){if(this.markerWrapper_||(this.markerWrapper_=document.createElement("DIV"),this.markerWrapper_.style.position="absolute"),this.getZIndex()&&(this.markerWrapper_.style.zIndex=this.getZIndex()),this.markerWrapper_.style.display=this.getVisible()?"":"none",!this.markerContent_){this.markerContent_=document.createElement("DIV"),this.markerWrapper_.appendChild(this.markerContent_);var t=this;google.maps.event.addDomListener(this.markerContent_,"click",function(o){google.maps.event.trigger(t,"click",o)}),google.maps.event.addDomListener(this.markerContent_,"mouseover",function(o){google.maps.event.trigger(t,"mouseover",o)}),google.maps.event.addDomListener(this.markerContent_,"mouseout",function(o){google.maps.event.trigger(t,"mouseout",o)})}this.ready_=!0,this.content_changed(),this.flat_changed(),this.draggable_changed();var r=this.getPanes();r&&r.overlayMouseTarget.appendChild(this.markerWrapper_),google.maps.event.trigger(this,"ready")},e.prototype.onAdd=e.prototype.onAdd,e.prototype.draw=function(){if(!(!this.ready_||this.dragging_)){var t=this.getProjection();if(!!t){var r=this.get("position"),o=t.fromLatLngToDivPixel(r),i=this.getOffset_();this.markerWrapper_.style.top=o.y+i.height+"px",this.markerWrapper_.style.left=o.x+i.width+"px";var s=this.markerContent_.offsetHeight,n=this.markerContent_.offsetWidth;n!=this.get("width")&&this.set("width",n),s!=this.get("height")&&this.set("height",s)}}},e.prototype.draw=e.prototype.draw,e.prototype.onRemove=function(){this.markerWrapper_&&this.markerWrapper_.parentNode&&this.markerWrapper_.parentNode.removeChild(this.markerWrapper_),this.removeDragListeners_()},e.prototype.onRemove=e.prototype.onRemove;var a={TOP_LEFT:1,TOP:2,TOP_RIGHT:3,LEFT:4,MIDDLE:5,RIGHT:6,BOTTOM_LEFT:7,BOTTOM:8,BOTTOM_RIGHT:9};window.RichMarkerPosition=a}
